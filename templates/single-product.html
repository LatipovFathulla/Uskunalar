{% extends 'layouts/base.html' %}
{% load i18n %}
{% block title %} {{ object.title }} {% endblock %}
{% load static %}
{% load tags %}
{% load embed_video_tags %}
{% load static watermark %}
{% load humanize %}
{% block content %}

<section class="banner">
    <div class="banner-container container">
        <h1 class="banner-text">{% trans '–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞' %}</h1>
        <div class="banner-links">
            <a href="{% url 'home:home' %}" style="color:#132E6B" class="banner-desc">{% trans '–ì–ª–∞–≤–Ω–∞—è' %} <span> > </span></a>
            <a href="{% url 'blog:blogs' %}" class="banner-desc-title" style="color:#132E6B;">{% trans '–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞' %}<span> > </span></a>
            <a href="" class="banner-desc-title" style="color:#132E6B;">{{ object.title }}</a>
            </div>
    </div>
</section>

<br>
<br> <div class="single-product-container">
        <div class="single-product_block">
            <div class="single-produce-backgroundinMobile">
                <div class="single-product-img-Holder">
                    <!-- Lists -->

                    <!-- Swiper -->
                    <div class="single-product-swiper mySwiper">
                        <ul class="swiper-wrapper single-product-images-list">
                              {% for i in object.images.all %}
                                {% if forloop.counter == 1 %}
                                <li class="swiper-slide single-product-images-option active">
                                    <img src="{{ i.image.url }}" alt="">
                                </li>
                                {% else %}
                                 <li class="swiper-slide single-product-images-option ">
                                    <img src="{{ i.image.url }}" alt="">
                                </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                    <!-- Image -->
                   {% for i in object.images.all %}
                       {% if forloop.counter == 1 %}
                            <div class="single-product-images-mainImage"
                                style="background: url({{ i.image.url }}) no-repeat center center / contain;"
                                oncontextmenu="return false;">
                                <!-- <img class="single-product-images-mainImage-img" src="./images/us11-removebg-preview.png" alt=""> -->
                            </div>
                        {% endif %}
                   {% endfor %}
                </div>
                <div class="single-product-share-block">
                    <buttun class="single-product-shareBtn"><i class="fa-light fa-share-nodes"></i></buttun>
                    <ul class="single-product-share-options">
                        <li class="single-product-share-option"><a href="https://t.me/share/url?url={{ request.get_host }}{{ request.get_full_path }}&text={{ object.title }}" target="_blank"><i class="fa-brands fa-telegram"></i></a></li>
                        <li class="single-product-share-option"><a href="https://www.facebook.com/sharer/sharer.php?u={{ request.get_host }}{{ request.get_full_path }}" target="_blank"><i class="fa-brands fa-facebook"></i></a></li>
                        <li class="single-product-share-option"><a href="https://wa.me/?text={{ request.get_host }}{{ request.get_full_path }}" target="_blank"><i class="fa-brands fa-whatsapp"></i></a></li>
                    </ul>
                </div>
            </div>
            <div class="single-product-content-Holder">
                <div class="single-product-content-container">
                    <!-- Title -->
                    <h2 class="single-prodcut-title">{{ object.title }}
                        {% if object.is_new %}
                            <span class="single-products-newproduct">{% trans 'New' %}</span>
                        {% endif %}
                    </h2>
                    <!-- Status and ID -->
                    <div class="single-product-status-block">
                        {% if object.inbox %}
                        <p class="single-product_status"><i class="fa-light fa-check"></i>{{ object.inbox }}</p>
                        {% endif %}
                        {% if object.delivery %}
                         <p class="single-product_status"><i class="fa-light fa-truck-bolt"></i>{{ object.delivery }}</p>
                        {% endif %}
                        <!-- <p class="single-product_status on-the-way"><i class="fa-light fa-clock-rotate-left"></i> Kelmoqda</p> -->
                        <span class="single-product_articuleID">ID: <span>{{ object.pk }}</span></span>
                    </div>
                    <!-- Short Description -->
                    <p class="single-product-short-description">{{ object.short_description|safe }}</p>

                    <!-- Convertation and Buy by Bank -->
                    <div class="single-product-miniBlock">
                        <!-- Convertation Icons -->
                        <ul class="single-product-miniInfo-list">
                            <li class="single-product-miniInfo-list-info">
                                <p class="single-product-miniInfo-list-infoTitle"><i
                                        class="fa-light fa-money-bill-transfer"></i> {% trans 'Konvertatsiya xizmatlari uchun' %} 1%
                                </p>
                            </li>
                            <li class="single-product-miniInfo-list-info list-dashed">
                                <p class="single-product-miniInfo-list-infoTitle"><i
                                        class="fa-light fa-building-columns"></i> {% trans 'Bank xizmatlari uchun' %} 0.5%</p>
                            </li>
                            <li class="single-product-miniInfo-list-info">
                                <p class="single-product-miniInfo-list-infoTitle"><i
                                        class="fa-light fa-badge-percent"></i> 15% QQS {% trans "(so'mda)" %}</p>
                            </li>
                        </ul>
                        <!-- Buy By Bank -->
                        <div class="single-product-buyFromBank-list-holder">
                            <h3 class="single-product-buyFromBank-list-title">{% trans 'Bank orqali xarid qilish' %}</h3>
                            <ul class="single-product-buyFromBank-list">
                                <li class="single-product-buyFromBank-bank">
                                    <a href="https://sqb.uz/uz/individuals/credits/" target="_blank"><img class="single-product-buyFromBank-bank-img" src="/static/images/sqb.png"
                                            alt=""></a>
                                </li>
                                <li class="single-product-buyFromBank-bank">
                                    <a href="https://qishloqqurilishbank.uz/ru/credits/dlya-fizicheskikh-lic" target="_blank"><img class="single-product-buyFromBank-bank-img" src="/static/images/qqb.png"
                                            alt=""></a>
                                </li>
                                <li class="single-product-buyFromBank-bank">
                                    <a href="https://www.ipotekabank.uz/private/crediting/" target="_blank"><img class="single-product-buyFromBank-bank-img"
                                            src="/static/images/ipoteka.png" alt=""></a>
                                </li>
                                <li class="single-product-buyFromBank-bank">
                                    <a href="https://trustbank.uz/oz/private/crediting/" target="_blank"><img class="single-product-buyFromBank-bank-img"
                                            src="/static/images/trastbank.png" alt=""></a>
                                </li>
                                <li class="single-product-buyFromBank-bank">
                                    <a href="https://www.infinbank.com/uz/private/credits/ipoteka/" target="_blank"><img class="single-product-buyFromBank-bank-img"
                                            src="/static/images/infinbank.png" alt=""></a>
                                </li>
                                <li class="single-product-buyFromBank-bank">
                                    <a href="https://hamkorbank.uz/uz/physical/credits/" target="_blank"><img class="single-product-buyFromBank-bank-img"
                                            src="/static/images/hamkorbank.png" alt=""></a>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Purchase-->
                    <div class="sinle-products-purchase-block">
                        <!-- Product Price Block -->
                        <div class="single-products-product-priceBlock">
                            <h3 class="single-products-product-priceBlock-title">{% trans 'Narxi' %}:</h3>
                            <div>
                                <div class="single-products-product-priceBlock-priceabout">
                                      {% if object.CIP == True %}
                                              <span title="INNKOTERMS - 2022 bo'yicha CIP Taskent" class="single-products-product-priceBlock-term cip-term">CIP</span>
                                       {% elif object.DAF == True %}
                                              <span title="INNKOTERMS - 2022 bo'yicha DAF" class="single-products-product-priceBlock-term daf-term">DAF</span>
                                       {% elif object.EXW == True %}
                                                 <span title="INNKOTERMS - 2022 bo'yicha EXW" class="single-products-product-priceBlock-term exw-term">EXW</span>
                                       {% elif object.FCA == True %}
                                                <span title="INNKOTERMS - 2022 bo'yicha FCA" class="single-products-product-priceBlock-term fca-term">FCA</span>
                                       {% endif %}

                                    {% if object.is_discount %}
                                            <h4 class="single-products-product-priceBlock-usdPrice">${{ object.get_price }}</h4>
                                             <h4 class="single-products-product-priceBlock-usdPrice d-d"><strike class="ml-2" style="font-size: 27px;color:#6c6b6b;font-weight: 400;">${{ object.price }}</strike></h4>

                                    {% else %}
                                             <h4 class="single-products-product-priceBlock-usdPrice">${{ object.get_price }}</h4>
                                       {% endif %}
                                </div>
                                {% if object.is_discount %}
                                       <h4 class="single-products-product-priceBlock-usdPrice d-m"><strike class="ml-2" style="font-size: 27px;color:#6c6b6b;font-weight: 400;">${{ object.price }}</strike></h4>
                                {% endif %}
                                <!-- <h4 class="single-products-product-priceBlock-usdPrice">$1000</h4> -->
                                <h5 class="single-products-product-priceBlock-uzsPrice"><span> </span> {% trans "so'm" %}</h5>
                            </div>
                        </div>

                        <!-- Purchase Button -->
                        <div class="single-products-product-purchase-container">
                            <button type="button" class="single-products-product-purchase-buy"><i
                                    class="fa-solid fa-cart-shopping"></i> {% trans 'Sotib Olish' %}</button>
                            {% if object.pdf %}
                                <a href="{{ object.pdf.url }}" target="_blank"><button type="submit" class="single-products-product-purchase-downloadPDf"><i
                                        class="fa-solid fa-file"></i> {% trans 'Pdf Yuklab olish' %}</button></a>
                            {% endif %}
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="single-product-characteristics-container">
            <div class="single-product-characteristics-options-block">
                <ul class="single-product-characteristics-options-list">
                    <li id="us-product-1" class="single-product-characteristics-options-option active">{% trans 'Xususiyatlari' %}
                    </li>
                    <li id="us-product-2" class="single-product-characteristics-options-option">{% trans 'Tavsifi' %}</li>
                    <li id="us-product-3" class="single-product-characteristics-options-option">{% trans 'Videolar' %}</li>
                    <li id="us-product-4" class="single-product-characteristics-options-option">{% trans 'Yetkazib Berish' %}</li>
                    <li id="us-product-5" class="single-product-characteristics-options-option">{% trans 'Kafolat shartlari' %}</li>
                </ul>
            </div>
            <div class="single-product-characteristics-optionInfo-block">
                <div id="us-product-1" class="single-product-characteristics-optionInfo-insideBlock active">
                    <ul>
                         {% for z in object.specifications.all %}
                              <li>
                                <p class="single-product-characteristics-title">{{ z.product_customer|safe }}</p>
                                <p class="single-product-characteristics-character">{{ z.product_number|safe }}</p>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                <div id="us-product-2" class="single-product-characteristics-optionInfo-insideBlock">
                    <p>{{ object.long_description|safe}}</p>
                </div>
                <div id="us-product-3" class="single-product-characteristics-optionInfo-insideBlock">
                    <div class="single-product-videoBlock" style="display: flex;justify-content: center;">
                         {% if object.video %}
                                {% video object.video '50%x520' %}
                         {% endif %}
                    </div>
                </div>
                <div id="us-product-4" class="single-product-characteristics-optionInfo-insideBlock">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Dignissimos, laboriosam modi quam
                        officiis, minus necessitatibus atque in vero ducimus obcaecati quod debitis temporibus laborum
                        eum non mollitia repellendus est doloremque architecto. Magni nulla libero accusantium quod
                        mollitia maiores obcaecati. Error voluptate quasi veniam. Quaerat aspernatur unde, temporibus
                        quae placeat blanditiis. Maiores aliquam est numquam obcaecati assumenda magnam cumque vitae
                        repudiandae accusantium quia. Non et, ratione a ipsum ex qui facilis vero provident, ad repellat
                        quasi reprehenderit. Neque voluptates rerum possimus et delectus velit commodi ab excepturi
                        accusantium placeat. Nostrum libero sequi totam obcaecati natus placeat ipsa excepturi ipsam
                        dignissimos officia.</p>
                </div>
                <div id="us-product-5" class="single-product-characteristics-optionInfo-insideBlock">
                    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Repudiandae, atque nam, debitis quis
                        maxime aperiam ipsa repellat aut, dolorem nobis aspernatur repellendus pariatur ducimus et
                        similique! Cum beatae, optio debitis, illum odio dolore amet eligendi magni necessitatibus
                        voluptates dolorem similique ex officia placeat exercitationem praesentium fugit tempora?
                        Cupiditate, asperiores voluptatibus odio nobis consequatur commodi minima ipsa architecto fuga
                        placeat inventore esse deserunt quam maxime autem, provident soluta? Explicabo fuga libero
                        asperiores, voluptates facere, officiis cum rerum architecto accusamus quibusdam minus facilis
                        illo. Consectetur, quisquam vel suscipit repellendus dicta, quis accusamus cum itaque amet nobis
                        illo animi voluptates nisi harum quaerat? Pariatur at nulla sint error, ullam, repudiandae
                        doloremque id unde iste quo quaerat ad tempore, delectus iusto corrupti vitae eveniet. Atque
                        facere cumque ea, sed eligendi quaerat iste voluptates beatae. Similique autem harum dicta
                        debitis cumque libero minima aperiam. Enim, laudantium inventore! Obcaecati quos animi repellat
                        eaque expedita aperiam iusto.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="single-product-finalpurchase-block">
        <div class="single-product-finalpurchase-block-holder">
            <div class="single-product-finalpurchase-block-container">
                <h3 class="single-product-finalpurchase-block-title">{% trans 'Biz bilan Aloqa' %}</h3>
                <p class="single-product-finalpurchase-block-description">{% trans "Ushbu uskunani xarid qilish uchun quyidagi formani to'ldiring va bizning operatorlarimiz tez orada siz bilan bog'lanishadi." %}</p>
                    <div class="single-product-finalpurchase-block-formBlock">
                        <form id="productForm" action="" onsubmit="submittedForm(); return false;">
                            <ul class="items"></ul>
                            <fieldset class="username enable">
                              <div class="icon left"><i class="user"></i></div>
                              <input class="user_name" type="text" name="name" placeholder="{% trans 'Ismingiz' %}"/>
                              <button class="icon right nextButton fa-regular fa-arrow-right"></button>
                            </fieldset>
                            <fieldset class="email">
                              <div class="icon left fa-regular fa-phone"></div>
                              <input class="user_tel" name="email" placeholder="+998 (77) 777-7777" type="tel" name="" id="phoneNumber" required/>
                              <button class="icon right nextButton fa-regular fa-arrow-right"></button>
                            </fieldset>
                            <fieldset class="thanks">
                                <div class="icon left fa-regular fa-circle-check"></div>
                                <p class="us-form-status">{% trans 'Xabar Muvaffaqiyatli Yuborildi' %}</p>
                              </fieldset>
                          </form>
                    </div>
                    <div class="single-product-finalpurchase-block-imgHolder">
                        <img src="/static/images/122_2.jpg" alt="" class="single-product-finalpurchase-block-img">
                    </div>
            </div>
        </div>
    </div>
            <br>
        </div>
    </div>
</div>
<br>
<br>

    <div class="container">
        <h1 class="text-center"
            style="font-weight: 600;font-size: 35px;padding: 20px;margin-top: 30px;margin-left: 5%;">
            {% trans '–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã' %}</h1>
        <p class="home-product-desc text-center" >{% trans "Uskunalar.uz ning mahsulotlar katalogi  <span id='year'></span>-yildagi jahonning eng innovatsion texnika-texnologiyalari bo'yicha ma'lumotlar bilan doimiy ravishda boyitib borilmoqda. Quyida esa Saytimiz kuzatuvchilarining qiziqishlari, talab va istaklari natijasida saralangan ommabop mahsulotlarni taqdim qilamiz. Bizni kuzatishda davom eting!" %}</p>
        <br>
        <hr style="border: 2px solid #ffe600;width: 100px;text-align: center;margin: auto;border-radius: 20px;">
        <br>

    </div>


<div class="container">
    <div class="row-1">
        <br>
        <div class="splide_3_2">
            <div class="splide__track">
                    <ul class="splide__list">
                     {% for product in related %}
                        <li class="splide__slide">
                             <div class="us-products">
                                  {% include 'layouts/product_block.html' %}
                              </div>
                        </li>
                      {% endfor %}
                    </ul>
                </div>
        </div>
    </div>
</div>


<div class="products-none">
      <div class="us-products">
            {% for product in related  %}
                {% include 'layouts/product_block.html' %}
            {% endfor %}
     </div>
</div>




<br>


<br>
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script src="https://rawgit.com/RobinHerbots/jquery.inputmask/3.x/dist/jquery.inputmask.bundle.js"></script>
<script>

    // Purchase Block
const purchaseBtn = document.querySelector('.single-products-product-purchase-buy');
const purchaseBlock = document.querySelector('.single-product-finalpurchase-block')
const StatusMessage = document.querySelector('.us-form-status');

purchaseBtn.addEventListener('click', (e) => {
    purchaseBlock.classList.add('active')
})


function next(target) {
    var input = target.previousElementSibling;

    // Check if input is empty
    if (input.value === '') {
        body2.classList.add('error');
    } else {
        body2.classList.remove('error');

        var enable = document.querySelector('form fieldset.enable'),
            nextEnable = enable.nextElementSibling;
        enable.classList.remove('enable');
        enable.classList.add('disable');
        nextEnable.classList.add('enable');

    }
}

function keyDown(event) {
    let key = event.keyCode;
    if (key == 13 || key == 9) {
        let target = document.querySelector('fieldset.enable button'),
            enable = document.querySelector('form fieldset.enable'),
            nextEnable = enable.nextElementSibling;

        next(target)

        // if (nextEnable.classList.contains('thanks') && enable.childNodes[3].value.length !== 0) {
        //     submitPurchaseInfo()
        // }
    };
}

var body2 = document.querySelector('body'),
    form = document.querySelector('form'),
    count = form.querySelectorAll('fieldset').length;


body2.addEventListener("mouseup", (event) => {
      var target = event.target || event.toElement;
        if (target.classList.contains("nextButton")) next(target);
})
document.addEventListener("keydown", keyDown, false);



    // Phone Mask
    $('#phoneNumber').inputmask("+999 (99) 999-99-99");

    // Disable Form
    $('.single-product-finalpurchase-block').mouseup((e) => {
        e.target.classList.remove('active')
    });

function submittedForm() {
    try {
        let lastInput = document.querySelector('fieldset input#phoneNumber')

        if (lastInput.value.length !== 0) {
            submitPurchaseInfo();
            setTimeout(() => {
                purchaseBlock.classList.remove('active');
                // window.location.reload();
            }, 1800);
        }
        else {
            alert('Please, fill out the form!')
        }

    } catch (error) {
        console.log(error);
    }
}


function submitPurchaseInfo() {
    try {
        // console.log("hello world");
        const token = "5475705900:AAFlmINyeHg10t-zIjcdHG_LKDquv3tu898";
        const chat_id = "-517105134";

        let formID = $('#productForm');
        let uname = $(formID).find(".user_name").val();
        let usertel = $(formID).find(".user_tel").val();
        let productTitle = document.querySelector('.single-prodcut-title').innerText;
        let productID = document.querySelector('.single-product_articuleID span').innerHTML;
        let productPriceDollar = document.querySelector('.single-products-product-priceBlock-usdPrice').innerText;
        let productPriceSom = document.querySelector('.single-products-product-priceBlock-uzsPrice').innerText;
        let productImg = document.querySelector('.single-product-images-mainImage'),
            style = productImg.currentStyle || window.getComputedStyle(productImg, false),
            finalImgUrl = style.backgroundImage.slice(4, -1).replace(/"/g, "");
        let anthrImg = 'https://uskunalar.uz/uploads/products/phpreFeS8.jpg'

        const caption = JSON.stringify(
            `<b>üì© Buyurtma qilingan mahsulot haqida:</b>%0A%0A<b>üî∏ Mahsulot nomi:</b> ${productTitle}%0A<b>üî∏ Mahsulot IDsi:</b> ${productID}%0A<b>üî∏ Mahsulot narxi (dollarda):</b> ${productPriceDollar}%0A<b>üî∏ Mahsulot narxi(so'mda):</b> ${productPriceSom}%0A__ __ __ __ __ __ __ __ __ __ __ __ __ __ __%0A%0A<b>üë§ Mijoz haqida:</b>%0A%0A<b>üîπ Mijoz Ismi:</b> ${uname}%0A<b>üîπ Telefon Raqami:</b> %2B ${usertel}`
        ).split('"')[1];
        // console.log(caption);
        // console.log(
        //     `https://api.telegram.org/bot${token}/sendPhoto?chat_id=${chat_id}&photo=${anthrImg}&parse_mode=html&caption=${caption}`
        // );


        $.ajax({
            type: "POST",
            url: `https://api.telegram.org/bot${token}/sendPhoto?chat_id=${chat_id}&photo=${anthrImg}&parse_mode=html&caption=${caption}`,
            data: formID.serialize(),
            success: function (data) {
                console.log(data);
                //  Shows modal window  / –í—ã–≤–æ–¥ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º, –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ
                // $("#exampleModalCenter").modal("show");
                // Reload Page
                setTimeout(function () {
                    // document.location.href = "./index.html";
                }, 2000);
            },
            error: function (jqXHR, text, error) {
                // TO DO : Message on error
            },
        });
        return false;
    } catch (error) {
        console.log(error);
    }
}
</script>
<script>
var swiper = new Swiper(".mySwiper", {
    direction: "horizontal",
    slidesPerView: 3,
    spaceBetween: 15,
    pagination: {
      el: ".swiper-pagination",
      clickable: true,
    },
  });
</script>
<script>
//   Slider Get  Image
const singleProductImages = document.querySelectorAll('.single-product-images-option img')
const singleProductImage = document.querySelector('.single-product-images-mainImage');
let lastActiveProductImage;

// singleProductImages[0].parentElement.classList.add('active');

singleProductImages.forEach(singleProductImageElement => {
    if (singleProductImageElement.parentElement.classList.contains('active')) {
        lastActiveProductImage = singleProductImageElement.parentElement;
    }
    singleProductImageElement.addEventListener('click', () => {
        const singleProductNewImage = singleProductImageElement.src.split('products/')[1];
        singleProductImage.style.background = `url(/media/products/${singleProductNewImage}) no-repeat center center / contain`
        lastActiveProductImage.classList.remove('active')
        lastActiveProductImage = singleProductImageElement.parentElement;
        singleProductImageElement.parentElement.classList.add('active')
    })
//    single-product-images-option
})



var zoomedImage = document.querySelector('.single-product-images-mainImage');

if (zoomedImage) {
// Zoom image on mouse enter.
zoomedImage.addEventListener('mouseenter', function(e) {
    this.style.backgroundSize = "200%";
}, false);


// Show different parts of image depending on cursor position.
zoomedImage.addEventListener('mousemove', function(e) {

    // getBoundingClientReact gives us various information about the position of the element.
    var dimentions = this.getBoundingClientRect();

    // Calculate the position of the cursor inside the element (in pixels).
    var x = e.clientX - dimentions.left;
    var y = e.clientY - dimentions.top;

    // Calculate the position of the cursor as a percentage of the total width/height of the element.
    var xpercent = Math.round(100 / (dimentions.width / x));
    var ypercent = Math.round(100 / (dimentions.height / y));

    // Update the background position of the image.
    this.style.backgroundPosition = xpercent+'% ' + ypercent+'%';

}, false);


// When leaving the container zoom out the image back to normal size.
zoomedImage.addEventListener('mouseleave', function(e) {
    this.style.backgroundSize = "contain";
    this.style.backgroundPosition = "center";
}, false);
}

// Product Characteristics

const characteristicsOptions = document.querySelectorAll('.single-product-characteristics-options-option');
const characteristicsContent = document.querySelectorAll('.single-product-characteristics-optionInfo-insideBlock');
let lastcharacteristicsOption, lastcharacteristicsListOption;

characteristicsOptions.forEach(element => {

    if (element.classList.contains('active')) {
        lastcharacteristicsListOption = element;
    }

    element.addEventListener('click', () => {
        lastcharacteristicsListOption.classList.remove('active');
        lastcharacteristicsListOption = element;
        element.classList.add('active')

        characteristicsContent.forEach(contentElement => {
            if (element.id === contentElement.id) {
                contentElement.classList.add('active')
            }
            else {
                contentElement.classList.remove('active')
            }
        })
    })
})


// Share Button
const shareBtn = document.querySelector('.single-product-shareBtn');
const shareBtnOption = document.querySelectorAll('.single-product-share-option');

shareBtn.addEventListener('click', () => {
    shareBtnOption.forEach(element => {
        element.classList.toggle('active')
    })
})
</script>
<script>
    function add_to_wishlist(element, pk) {
        $.getJSON('/products/' + "wishlist/" + pk, function (data) {
            if (!data.status) {
               $('#message').append(`<div style="padding:5px">
                        <div id="inner-message" class="alert alert-error">
                            <button type="button" class="close" data-dismiss="alert">&times;</button>
                            Error
                        </div>
                    </div>`);
            } else {
                if (data.added) {
                    element.innerHTML = '<button class="us-products-card_ibutton product-heart" type="submit"><i class="fa-solid fa-heart red-heart"></i></button>'
                } else {
                    element.innerHTML = '<button class="us-products-card_ibutton" type="submit"><i class="fa-light fa-heart"></i></button>'
                }
                  $('#like_count').html(data.wishlist_len);
                  $('#like_count_2').html(data.wishlist_len);
            }
        });
    }
</script>
<script>
  var splide = new Splide('.splide_3_2', {
    perPage: 1,
    rewind: true,
  });

  splide.mount();
</script>
<script>
$(".nav-2 li").hover(function () {
	$(this).children("ul").stop().delay(200).animate({height: "toggle", opacity: "toggle"}, 200);
});
</script>
<script>
    $(function() {
	var Accordion = function(el, multiple) {
		this.el = el || {};
		this.multiple = multiple || false;

		// Variables privadas
		var links = this.el.find('.link');
		// Evento
		links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
	}

	Accordion.prototype.dropdown = function(e) {
		var $el = e.data.el;
			$this = $(this),
			$next = $this.next();

		$next.slideToggle();
		$this.parent().toggleClass('open');

		if (!e.data.multiple) {
			$el.find('.submenu').not($next).slideUp().parent().removeClass('open');
		};
	}

	var accordion = new Accordion($('#accordion6_4'), false);
});


</script>
<script>
       // Currency
        const SingleApiUrl2 = 'https://nbu.uz/en/exchange-rates/json/'
        const usdSinglePrice = document.querySelector('.single-products-product-priceBlock-usdPrice').innerHTML.substring(1);
        const uzsSinglePrice = document.querySelector('.single-products-product-priceBlock-uzsPrice span')

        // Currency
        async function singleExchangeCurrency(usd, element) {
            let response = await fetch(SingleApiUrl2);

            if (response.ok) {
                let json = await response.json();
                let CurrencyRate = json[json.length - 1]['cb_price'];
                let qqs = 15;
                let finalPrice = Math.floor(CurrencyRate * usd + (CurrencyRate * usd * qqs/100));
                element.innerHTML = finalPrice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
            } else {
                alert("HTTP-Error: " + response.status);
            }
        }


         singleExchangeCurrency(usdSinglePrice, uzsSinglePrice)


</script>


{% endblock %}