{% extends 'layouts/base.html' %}
{% load i18n %}
{% block title %} {% trans 'Mahsulotlar' %} {% endblock %}
{% load static %}
{% load paginator_tags %}
{% load humanize %}
{% load tags %}
{% block content %}


    <style>
        /* scrollbar */
.us-products-page-categories-listHolder *::-webkit-scrollbar {
    width: 2px;
    transition: all .5s ease;
  }
.us-products-page-categories-listHolder:hover *::-webkit-scrollbar {
    width: 5px;
    transition: all .5s ease;
  }

  /* Track */
  .us-products-page-categories-listHolder *::-webkit-scrollbar-track {
    background: #ffe600;
  }

  /* Handle */
  .us-products-page-categories-listHolder *::-webkit-scrollbar-thumb {
    background: #202020;
  }

  /* Handle on hover */
  .us-products-page-categories-listHolder *::-webkit-scrollbar-thumb:hover {
      background: #202020;
  }
/* End horizontal */
        nav ul li a span strong {
            color: #fff;
            font-size: 15px;
        }

        strong {
            color: #000;
            font-size: 13px;
        }

        @media screen and (max-width: 950px) {
            #accordion2 {
                display: none;
            }

            #accordion {
                display: none;
            }

            .categories_none {
                display: none;
            }

            .product-new-us {
                max-width: 1370px;
                width: 100%;
                margin: auto;
                /* background: chartreuse; */
                padding: 10px;
                display: grid;
                grid-template-columns: repeat(1, 1fr);
                grid-template-rows: repeat(1, 1fr);
                grid-gap: 10px;
            }

            .products-flex {
                display: initial;
                max-width: 1370px;
                width: 100%;
                margin: auto;
            }

            .category-none {
                display: none;
            }
        }

        .modal-content {
            position: relative;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-direction: column;
            flex-direction: column;
            width: 100%;
            pointer-events: auto;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid rgba(0, 0, 0, .2);
            border-radius: 0.3rem;
            outline: 0;
        }

        @media (min-width: 1199px) {
            .category-ds-1 {
                display: none
            }

            .minimalist-tab-content2.active {
                display: grid;
                width: 800px;
                height: auto;
                left: 280px;
                opacity: 1;
                visibility: visible;
                position: absolute;
                z-index: 999;
            }

            #Paris.btn-like3 {
                position: absolute;
                bottom: 20%;
                right: 13%;
                width: 48px;
                height: 48px;
                background-color: #FFF5F5;
                border: none;
                border-radius: 4px;
            }
        }

        @media (min-width: 1200px) {
            .product-new-us {
                max-width: 1370px;
                width: 100%;
                margin: auto;
                /* background: chartreuse; */
                padding: 10px;
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(1, 1fr);
                grid-gap: 10px;
            }

            .products-flex {
                display: flex;
                max-width: 1370px;
                width: 100%;
                margin: auto;
            }

        }

        accordion {
            font-size: 1rem;
            width: 30vw;
            margin: 0 auto;
            border-radius: 5px;
        }


        .accordion-body {
            background: white;
        }

        .accordion-header {
            color: #132E6B;
            cursor: pointer;
            font-size: .7em;
            letter-spacing: .1em;
            transition: all .3s;
            background-color: #CCCCCA;
        }


        .accordion__item .accordion__item {
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }

        .accordion-header:hover {
            position: relative;
            z-index: 5;
        }

        .accordion-body {
            background: #fcfcfc;
            color: #353535;
            display: none;
        }

        .accordion-body__contents {
            padding: 7px 1.5em;
            font-size: 19px;
            font-weight: 500;
        }

        .accordion__item.active:last-child .accordion-header {
            border-radius: none;
        }

        .accordion:first-child > .accordion__item > .accordion-header {
            border-bottom: 1px solid #CCCCCA;
        }


        .accordion__item.active > .accordion-header:after {
            transform: rotate(-180deg);
        }

        .accordion__item.active .accordion-header {
            background: #FFE700;
        }

        .accordion__item .accordion__item .accordion-header {
            background: #f1f1f1;
            color: #353535;
        }

        @media screen and (max-width: 1000px) {
            .accordion {
                width: 100%;
            }

            .category-ds-1 {
                display: none;
            }

            .modal {
                top: 15%;
            }
        }

        .tablinks {
            color: #a0a0a0;
            font-width: 500;
            font-size: 24px;
            transition: .5s linear;
        }

        .tablinks:hover{
            color: #333;
        }

        .tablinks.active i {
            color: #333;
        }

      .us-mobile-products-horizontal-card-discount {
        background-color: #333;
        color: #fec20f;
        padding: 2px 5px;
        border-radius: 6px;
        font-size: 18px;
    }


.us-products-page-products-productCard-term {
    cursor: pointer;
}

.us-products-page-products-productCard-term-BLockBackground {
    position: fixed;
    top: 0;
    left: 0;
    background: #333333b9;
    width: 100vw;
    height: 100%;
    overflow: hidden;
    overflow-y: scroll;
    visibility: hidden;
    opacity: 0;
    transition: all .3s ease;
}
.us-products-page-products-productCard-term-BLockBackground, .us-products-page-products-productCard-term-block {
    transition: all .3s ease;
}

.us-products-page-products-productCard-term-BLockBackground.active {
    visibility: visible;
    opacity: 1;
}

.us-products-page-products-productCard-term-block {
    margin: auto;
    background-color: #fff;
    max-width: 1200px;
    width: 100%;
}

.productCard-term-content {
    background: #333;
    /* background: #132E6B; */
    padding: 30px 20px 20px 20px;
    display: flex;
    flex-direction: column;
}
.productCard-term-close_btn{
    align-self: flex-end;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
}

.productCard-term-title {
    margin-top: 20px;
    font-size: 34px;
    color: #fff;
}
.productCard-term-title::after {
    content: '';
    display: block;
    height: 2px;
    background-color: #ffe600;
    width: 25%;
}
.productCard-term-desc p{
    margin-top: 10px;
    font-size: 18px;
    color: #fff;
}

.productCard-term-img {
    /* max-width: 600px; */
    width: 90%;
    margin: auto;
    margin-top: 15px;
}

.productCard-term-content-maincontent {
    padding: 20px;
}

*::selection {
    color: #333;
    background-color: #ffe600;
}


    </style>
 <!-- New product block -->
     <div class="us-navigation-block">
        <div class="us-products-page-container">
            <ul class="us-navigation-block-list">
                <li class="us-navigation-block-item">
                    <a href="{% url 'index' %}" class="us-navigation-block-link">{% trans 'Главная' %}</a>
                </li>
                <li class="us-navigation-block-item">
                    <a href="{% url 'products:product' %}" class="us-navigation-block-link">{% trans 'Каталог' %}</a>
                </li>
            </ul>
        </div>
    </div>

    <section class="us-products-page">
        <div class="us-products-page-container">
            <div class="us-products-page-holder">
                <div id="categroySideBar" class="us-products-page-categories-holder">
                 {% with categories2 as all_categories  %}
                    <div class="us-products-page-categories-container">
                        <div class="us-products-page-categories-searchBlock">
                            <i class="fa-light fa-magnifying-glass"></i>
                            <input type="search" class="us-products-page-categories-searchBlock-input" type="text"
                                placeholder="{{ cat_count }} {% trans 'categories' %}">
                        </div>
                        <div class="us-products-page-categories-listHolder">
                            <ul class="us-products-page-categories-list">

                             {% for category in all_categories %}
                                <li id="us-submenu-{{ category.pk }}" class="us-products-page-categories-list-item">
                                    <a href="?category={{ category.pk }}">
                                        <span class="us-products-page-categories-list-item-title title-active"><img
                                                class="us-categories-label-img" src="{{ category.image.url }}" alt="">
                                            {{ category.category|safe }}</span>
                                    </a>
                                    <button class="us-products-page-categories-list-item-button"><i
                                            class="fa-regular fa-angle-right"></i></button>
                                </li>
                             {% endfor %}

                            </ul>

                            <!-- Subcategories list -->
                         {% for category in all_categories %}
                            <div id="us-submenu-{{ category.pk }}" class="us-products-page-subcategories-listHolder">
                                <button class="us-products-page-subcategories-backButton"><i
                                        class="fa-regular fa-arrow-left-long closeSubBtn"></i>{{ category.category|safe }}</button>
                                <ul class="us-products-page-subcategories-list">
                                           {% for subcategory in category.subcategories.all %}
                                            <li class="us-products-page-subcategories-list-item">
                                                <a href="?subcategory={{ subcategory.pk }}">
                                                    <span class="us-products-page-subcategories-list-item-title title-active">{{ subcategory|safe }}</span>
                                                </a>
                                                <span class="us-products-page-subcategories-list-item-count">({{ subcategory.products.count }})</span>
                                            </li>
                                           {% endfor %}
                                </ul>
                            </div>
                        {% endfor %}

                            <!-- Search Block -->
                            <ul class="us-products-page-searchcategories-list">
                                <!-- <li class="us-products-page-categories-list-item">
                                    <a href="">
                                        <span class="us-products-page-categories-list-item-title title-active">Memak</span>
                                    </a>
                                </li> -->
                            </ul>
                        </div>
                  {% endwith %}
                    </div>
                </div>
                <div class="us-products-page-products-holder">
                    <div class="us-products-page-products-container">
                        <h1 class="us-products-page-products-catTitle">
                            {% if request.GET.category %}
                                {{ categories|get_category_name:request.GET.category }}
                            {% elif request.GET.subcategory %}
                                {{ subcategories|get_subcategory_name:request.GET.subcategory }}
                            {% else %}
                                {% trans 'Mahsulotlar' %}
                            {% endif %}
                         {% if request.GET.category %}
                             <span>{{ cat_count }}</span>
                           {% elif request.GET.subcategory %}
                                <span>{{ sub_cat_count }}</span>
                            {% else %}
                            {% for product in products|slice:":1" %}
                                <span>{{ pr_count }}</span>
                            {% endfor %}
                         {% endif %}
                        </h1>

                        <!-- Filter Section -->
                        <div class="us-products-page-filterBlock">
                            <ul>
{#                                  <select onchange="addUrlParameter('sort', this.value)">#}
{#                                                                        <option>{% trans 'Все товары' %}</option>#}
{#                                                                        <option {% if request.GET.sort == 'price' %}selected{% endif %}#}
{#                                                                                value="price">{% trans 'Сначала дешевые' %}</option>#}
{#                                                                        <option {% if request.GET.sort == '-price' %}selected{% endif %}#}
{#                                                                                value="-price">{% trans 'Сначала дорогие' %}</option>#}
{#                                                                        <option {% if request.GET.sort == 'created_at' %}selected{% endif %}#}
{#                                                                                value="created_at">{% trans 'Новые' %}</option>#}
{##}
{##}
{#                                                                    </select>#}
                               <li class="us-products-page-filterBlock-item {% if request.GET.sort == 'created_at' %}active{% endif %}" onclick="addUrlParameter('sort', 'created_at')">{% trans 'New' %}</li>
                                <li class="us-products-page-filterBlock-item {% if request.GET.sort == 'price' %}active{% endif %}" onclick="addUrlParameter('sort', 'price')">{% trans "Narxiga ko'ra" %}</li>
                                <li class="us-products-page-filterBlock-item {% if request.GET.sort == 'view_count' %}active{% endif %}" onclick="addUrlParameter('sort', 'view_count')">{% trans "Ommabopligi bo'yicha" %}</li>
                            </ul>

                                <ul>
                                    <li>
                                        <button class="us-products-page-filterBlock-viewBtn price-filter">{% trans 'Narxi' %}</button>
                                    </li>
                                    <li>
                                    <button class="us-products-page-filterBlock-viewBtn gridView active"><i
                                            class="fa-regular fa-grid-2"></i></button>
                                    </li>
                                    <li>
                                        <button class="us-products-page-filterBlock-viewBtn horView"><i
                                                class="fa-regular fa-diagram-cells"></i></button>
                                    </li>
                                </ul>

                                <div class="us-products-page-filtersection-pricefilterBox">
                                       <form action="">
                                         <input class="js-range-slider" name="js-range-slider"/>
                                       </form>
                                </div>
                        </div>

                        <!-- Products Section -->
                        <div class="us-products-page-products-grid">
                            <ul class="us-products-page-products-grid-list active">
                                {% for product in products %}
                                        {% include 'layouts/product-block2.html' %}
                                {% endfor %}
                            </ul>
                        </div>
                     <!-- Horizontal View -->
                            <div class="us-products-page-products-horizontal-view">
                                <!-- Product Card -->
                                {% for product in products %}
                                    {% include 'layouts/product-sort2.html' %}
                                {% endfor %}
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
 <!-- End new product block -->
    <nav aria-label="Page navigation example" style="margin: 20px auto;display: flex;justify-content: center;">
        {% if page_obj.has_previous %}
            <li class="page-previous"><a href="?page={{ page_obj.previous_page_number }}"><i class="fa-light fa-angle-left"
                                                                                     style="color: #132E6B;font-weight: 500;"></i></a></li>
        {% else %}
            <li class="disabled"><span><img src="/static/images/left.svg" style="display:none" alt=""></span></li>
        {% endif %}
        <ul style="display: flex;justify-content: center;">
            {% if page_obj.has_previous <= page_obj.number|add:'-2' %}
                <li class="page_numb"><a href="?page=1" style="color: #132E6B;">1</a></li>
            {% endif %}
            {% for page in page_obj.paginator.page_range %}
                {% if page_obj.number == page %}
                    <li class="page_numb-active"><a style="color: #132E6B;">{{ page }}</a></li>
                {% elif page > page_obj.number|add:'-2' and page < page_obj.number|add:'3' %}
                    <li class="page_numb"><a rel="next" href="{% relative_url page 'page' request.GET.urlencode %}"
                                             style="color: #132E6B;">{{ page }}</a></li>
                {% endif %}
            {% endfor %}
            {% if page_obj.has_next %}
                {% if page_obj.number <= page_obj.paginator.num_pages %}
                    <li class="page-dotted"><a
                            href="{% relative_url page_obj.number|add:'3' 'page' request.GET.urlencode %}">&hellip;</a>
                    </li>
                {% endif %}
            {% endif %}
            {% if page_obj.has_next %}
                <li class="page_numb"><a
                        href="{% relative_url page_obj.paginator.num_pages 'page' request.GET.urlencode %}"
                        style="color: #132E6B;">{{ page_obj.paginator.num_pages }}</a></li>
            {% endif %}
        </ul>
        {% if page_obj.has_next %}
            <li class="page-next"><a href="?page={{ page_obj.next_page_number }}"><i class="fa-light fa-angle-right"
                                                                                     style="color: #132E6B;font-weight: 500;"></i></a>
            </li>
        {% else %}
            <li class="disabled"><span><i class="fa-light fa-angle-right" style="display: none"></i></span></li>
        {% endif %}
    </nav>
    <div class="container">
        <div class="back_elements" style="margin-top: 1%;">

        </div>
        <img src="{% static './images/Group_417.svg' %}" class="icon-right-transform" style="position: absolute;"
             alt="">
        <h2 class="text-center"
            style="font-weight: 600;font-size: 35px;padding: 20px;margin-top: 30px;margin-left: 5%;">
            {% trans 'Популярные товары' %}</h2>
        <p class="home-product-desc text-center" >{% trans "Uskunalar.uz ning mahsulotlar katalogi  <span id='year'></span>-yildagi jahonning eng innovatsion texnika-texnologiyalari bo'yicha ma'lumotlar bilan doimiy ravishda boyitib borilmoqda. Quyida esa Saytimiz kuzatuvchilarining qiziqishlari, talab va istaklari natijasida saralangan ommabop mahsulotlarni taqdim qilamiz. Bizni kuzatishda davom eting!" %}</p>
        <br>
        <br>
        <hr style="border: 2px solid #ffe600;width: 100px;text-align: center;margin: auto;border-radius: 20px;">
        <br>
    </div>



<div class="container">
       <div class="us-products-page-products-grid">
       <ul class="us-products-page-products-grid-list active">
            {% for product in random_products|slice:'4' %}
                {% include 'layouts/product-block2.html' %}
            {% endfor %}
       </ul>
    </div>

</div>
            {% for product in products %}
                {% if product.type %}
                     <div class="us-products-page-products-productCard-term-BLockBackground">
                            <div class="us-products-page-products-productCard-term-block">
                                        <div class="productCard-term-content">
                                            <span class="productCard-term-close_btn"><i class="fa-regular fa-xmark-large"></i></span>
                                            <img src="{% static 'images/incoterms banner.jpg' %}" alt="" class="productCard-term-img">
                                            <h3 class="productCard-term-title">{{ product.type }}2</h3>
                                            <div class="productCard-term-desc">{{ product.type.short_descriptions|safe }}</div>
                                        </div>
                                        <div class="productCard-term-content-maincontent">
                                            <!-- Content from Backend -->
                                            {{ product.type.long_descriptions|safe }}
                                        </div>
                            </div>
                        </div>
                {% endif %}
            {% endfor %}

{% endblock %}
<!-- Articul id ++++++-->
<!-- 4,5 -->

{% block extra_js %}
<script>
const menuBarCategories = document.querySelector('.menu-categories-section');
const wakeUpButton = document.querySelector('.menu_bar-categories-button');
const menuBarCategoriesItems = document.querySelectorAll('.menu-categories-button')
const submenuCategories = document.querySelectorAll('.submenu-categories-section')
const submenuCategoriesItems = document.querySelectorAll('.submenu-categories-button')
const submenuCloseButtons = document.querySelectorAll('.us-submenu-close')
let menuBarCategoriesIsAwake = false;

wakeUpButton.addEventListener('click', () => {

    menuBarCategoriesIsAwake = !menuBarCategoriesIsAwake;

    if (menuBarCategoriesIsAwake) {
        menuBarCategories.classList.remove('sleep')
        menuBarCategories.classList.add('wakeUp')
        wakeUpButton.classList.add('active');

        menuBarCategoriesItems.forEach(element => {
            if (element.classList.contains('active')) {
                element.classList.remove('active')
            }
        });

        showCategories(menuBarCategoriesItems, 0);

    }
    else {
        menuBarCategories.classList.remove('wakeUp');
        menuBarCategories.classList.add('sleep');
        submenuCategories.forEach(element => {
            if (element.classList.contains('wakeUp')) {
                element.classList.remove('wakeUp');
                element.classList.add('sleep');
            }
        })
        wakeUpButton.classList.remove('active');
        menuBarCategoriesItems.forEach(element => {
            element.classList.remove('active')
        })
        submenuCategoriesItems.forEach(element => {
            element.classList.remove('active')
        })
    }
})


function showCategories(element, increment) {
    let id = null;
    clearInterval(id);
    id = setInterval(frame, 300);
    function frame() {
        if (increment == menuBarCategoriesItems.length) {
            clearInterval(id);
        } else {
            element[increment].classList.add('active')
            increment++;
        }
    }
}

// Submenu
menuBarCategoriesItems.forEach(element => {
    element.addEventListener('click', () => {
        let ElementID = element.id
        submenuCategories.forEach(subelement => {
            if (ElementID === subelement.id) {
                if (subelement.classList.contains('sleep')) {
                    subelement.classList.remove('sleep');
                }
                subelement.classList.add('wakeUp');
                showCategories(submenuCategoriesItems, 0);
            }
        });
    } )
})

// Close SubMenu
submenuCloseButtons.forEach(element => {
    element.addEventListener('click', () => {
        element.closest(".submenu-categories-section").classList.remove('wakeUp')
        element.closest(".submenu-categories-section").classList.add('sleep')
    })
})
</script>
    <script>
        $('.btn1').click(function () {
            $(this).toggleClass("click");
            $('.sidebar').toggleClass("show");
        });
        $('.feat-btn').click(function () {
            $('nav ul .feat-show').toggleClass("show");
            $('nav ul .first').toggleClass("rotate");
        });
        $('.serv-btn').click(function () {
            $('nav ul .serv-show').toggleClass("show1");
            $('nav ul .second').toggleClass("rotate");
        });
        $('nav ul li').click(function () {
            $(this).addClass("active").siblings().removeClass("active");
        });
    </script>
    <script>
        $(function () {
            var Accordion = function (el, multiple) {
                this.el = el || {};
                this.multiple = multiple || false;

                // Variables privadas
                var links = this.el.find('.link');
                // Evento
                links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
            }

            Accordion.prototype.dropdown = function (e) {
                var $el = e.data.el;
                $this = $(this),
                    $next = $this.next();

                $next.slideToggle();
                $this.parent().toggleClass('open');

                if (!e.data.multiple) {
                    $el.find('.submenu').not($next).slideUp().parent().removeClass('open');
                }
                ;
            }

            var accordion = new Accordion($('#accordion2'), false);
        });


    </script>



    <script>
        $(function () {
            var Accordion = function (el, multiple) {
                this.el = el || {};
                this.multiple = multiple || false;

                // Variables privadas
                var links = this.el.find('.link');
                // Evento
                links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
            }

            Accordion.prototype.dropdown = function (e) {
                var $el = e.data.el;
                $this = $(this),
                    $next = $this.next();

                $next.slideToggle();
                $this.parent().toggleClass('open');

                if (!e.data.multiple) {
                    $el.find('.submenu').not($next).slideUp().parent().selected('true');
                }
                ;
            }

            var accordion = new Accordion($('#accordion'), false);
        });


    </script>
    <script>
        $(function () {
            var Accordion = function (el, multiple) {
                this.el = el || {};
                this.multiple = multiple || false;

                // Variables privadas
                var links = this.el.find('.link');
                // Evento
                links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
            }

            Accordion.prototype.dropdown = function (e) {
                var $el = e.data.el;
                $this = $(this),
                    $next = $this.next();

                $next.slideToggle();
                $this.parent().toggleClass('open');

                if (!e.data.multiple) {
                    $el.find('.submenu').not($next).slideUp().parent().removeClass('open');
                }
                ;
            }

            var accordion = new Accordion($('#accordion4_2'), false);
        });
    </script>

    <script>
        $(".js-range-slider").ionRangeSlider({
            type: "double",
            grid: true,
            min: {{ min_price }},
            max: {{ max_price }},
            from: {% get_price request 0 %},
            to: {% get_price request 1 %},
            prefix: '$',
            onFinish(data) {
                let result = data.from.toString() + ';' + data.to.toString()
                addUrlParameter('price', result);
            }
        });
    </script>

    <!--asd-->
    <script>
        var splide = new Splide('.splide_3_2', {
            perPage: 1,
            rewind: true,
        });

        splide.mount();


    </script>
    <script>
        function addUrlParameter(name, value) {
            let searchParams = new URLSearchParams(window.location.search)
            if (['category', 'subcategory', 'sku', 'sort', 'som'].includes(name)) {
                searchParams.delete('page');
            }
            if (searchParams.has(name) && searchParams.get(name) === value) {
                searchParams.delete(name);
            } else {
                searchParams.set(name, value)
            }
            window.location.search = searchParams.toString()
        }
    </script>
    <script>

        const accordionBtns = document.querySelectorAll(".us-categories-label");
        let array = []
        accordionBtns.forEach((accordion) => {

            accordion.onclick = function () {
                if (!this.parentElement.classList.contains("active")) {
                    if (!array.includes(this)) {
                        array.push(this)
                    } else {
                        // console.log(this);
                    }
                }


                if (array.length > 1) {
                    array.forEach((openAccardion, index) => {
                        if (index = array.length - 1) {
                            openAccardion.parentElement.classList.remove('active')
                            array.shift()
                        }
                    })
                    // array[0].parentElement.classList.remove("active")

                    this.parentElement.classList.toggle("active");

                } else {
                    this.parentElement.classList.toggle("active");
                }


                let content = this.nextElementSibling;
                let accordionHeight = content.scrollHeight + "px";
                //if the accordion is currently closed
                document.documentElement.style.setProperty('--subaccardion-height', accordionHeight);

                // console.log(array);
            };
        });

    </script>
    <script>
        window.onload = function () {
            crear_select();
        }

        function isMobileDevice() {
            window.onload = function () {
                crear_select();
            }
        };


        var li = new Array();

        function crear_select() {
            var div_cont_select = document.querySelectorAll("[data-mate-select='active']");
            var select_ = '';
            for (var e = 0; e < div_cont_select.length; e++) {
                div_cont_select[e].setAttribute('data-indx-select', e);
                div_cont_select[e].setAttribute('data-selec-open', 'false');
                var ul_cont = document.querySelectorAll("[data-indx-select='" + e + "'] > .cont_list_select_mate > ul");
                select_ = document.querySelectorAll("[data-indx-select='" + e + "'] >select")[0];
                if (isMobileDevice()) {
                    select_.addEventListener('change', function () {
                        _select_option(select_.selectedIndex, e);
                    });
                }
                var select_optiones = select_.options;
                document.querySelectorAll("[data-indx-select='" + e + "']  > .selecionado_opcion ")[0].setAttribute('data-n-select', e);
                document.querySelectorAll("[data-indx-select='" + e + "']  > .icon_select_mate ")[0].setAttribute('data-n-select', e);
                for (var i = 0; i < select_optiones.length; i++) {
                    li[i] = document.createElement('li');
                    if (select_optiones[i].selected == true || select_.value == select_optiones[i].innerHTML) {
                        li[i].className = 'active';
                        document.querySelector("[data-indx-select='" + e + "']  > .selecionado_opcion ").innerHTML = select_optiones[i].innerHTML;
                    }
                    ;
                    li[i].setAttribute('data-index', i);
                    li[i].setAttribute('data-selec-index', e);
// funcion click al selecionar
                    li[i].addEventListener('click', function () {
                        _select_option(this.getAttribute('data-index'), this.getAttribute('data-selec-index'));
                    });

                    li[i].innerHTML = select_optiones[i].innerHTML;
                    ul_cont[0].appendChild(li[i]);

                }
                ; // Fin For select_optiones
            }
            ; // fin for divs_cont_select
        } // Fin Function


        var cont_slc = 0;

        function open_select(idx) {
            var idx1 = idx.getAttribute('data-n-select');
            var ul_cont_li = document.querySelectorAll("[data-indx-select='" + idx1 + "'] .cont_select_int > li");
            var hg = 0;
            var slect_open = document.querySelectorAll("[data-indx-select='" + idx1 + "']")[0].getAttribute('data-selec-open');
            var slect_element_open = document.querySelectorAll("[data-indx-select='" + idx1 + "'] select")[0];
            if (isMobileDevice()) {
                if (window.document.createEvent) { // All
                    var evt = window.document.createEvent("MouseEvents");
                    evt.initMouseEvent("mousedown", false, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
                    slect_element_open.dispatchEvent(evt);
                } else if (slect_element_open.fireEvent) { // IE
                    slect_element_open.fireEvent("onmousedown");
                } else {
                    slect_element_open.click();
                }
            } else {


                for (var i = 0; i < ul_cont_li.length; i++) {
                    hg += ul_cont_li[i].offsetHeight;
                }
                ;
                if (slect_open == 'false') {
                    document.querySelectorAll("[data-indx-select='" + idx1 + "']")[0].setAttribute('data-selec-open', 'true');
                    document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .cont_list_select_mate > ul")[0].style.height = hg + "px";
                    document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .icon_select_mate")[0].style.transform = 'rotate(180deg)';
                } else {
                    document.querySelectorAll("[data-indx-select='" + idx1 + "']")[0].setAttribute('data-selec-open', 'false');
                    document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .icon_select_mate")[0].style.transform = 'rotate(0deg)';
                    document.querySelectorAll("[data-indx-select='" + idx1 + "'] > .cont_list_select_mate > ul")[0].style.height = "0px";
                }
            }

        } // fin function open_select

        function salir_select(indx) {
            var select_ = document.querySelectorAll("[data-indx-select='" + indx + "'] > select")[0];
            document.querySelectorAll("[data-indx-select='" + indx + "'] > .cont_list_select_mate > ul")[0].style.height = "0px";
            document.querySelector("[data-indx-select='" + indx + "'] > .icon_select_mate").style.transform = 'rotate(0deg)';
            document.querySelectorAll("[data-indx-select='" + indx + "']")[0].setAttribute('data-selec-open', 'false');
        }


        function _select_option(indx, selc) {
            if (isMobileDevice()) {
                selc = selc - 1;
            }
            var select_ = document.querySelectorAll("[data-indx-select='" + selc + "'] > select")[0];

            var li_s = document.querySelectorAll("[data-indx-select='" + selc + "'] .cont_select_int > li");
            var p_act = document.querySelectorAll("[data-indx-select='" + selc + "'] > .selecionado_opcion")[0].innerHTML = li_s[indx].innerHTML;
            var select_optiones = document.querySelectorAll("[data-indx-select='" + selc + "'] > select > option");
            for (var i = 0; i < li_s.length; i++) {
                if (li_s[i].className == 'active') {
                    li_s[i].className = '';
                }
                ;
                li_s[indx].className = 'active';

            }
            ;
            select_optiones[indx].selected = true;
            select_.selectedIndex = indx;
            select_.onchange();
            salir_select(selc);
        }
    </script>
    <script>
        $(function () {
            var Accordion = function (el, multiple) {
                this.el = el || {};
                this.multiple = multiple || false;

                // Variables privadas
                var links = this.el.find('.link');
                // Evento
                links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
            }

            Accordion.prototype.dropdown = function (e) {
                var $el = e.data.el;
                $this = $(this),
                    $next = $this.next();

                $next.slideToggle();
                $this.parent().toggleClass('open');

                if (!e.data.multiple) {
                    $el.find('.submenu').not($next).slideUp().parent().removeClass('open');
                }
                ;
            }

            var accordion = new Accordion($('#accordion7_2'), false);
        });

    </script>
    <script>
        (function () {

            $(".hamburger").on("click", function () {
                $(this).parent(".hamburger-wrapper").toggleClass("hamburger-active")
            });

        }());
    </script>
    <script>
        var accordion = (function () {

            var $accordion = $('.js-accordion');
            var $accordion_header = $accordion.find('.js-accordion-header');
            var $accordion_item = $('.js-accordion-item');

            // default settings
            var settings = {
                // animation speed
                speed: 400,

                // close all other accordion items if true
                oneOpen: false
            };

            return {
                // pass configurable object literal
                init: function ($settings) {
                    $accordion_header.on('click', function () {
                        accordion.toggle($(this));
                    });

                    $.extend(settings, $settings);

                    // ensure only one accordion is active if oneOpen is true
                    if (settings.oneOpen && $('.js-accordion-item.active').length > 1) {
                        $('.js-accordion-item.active:not(:first)').removeClass('active');
                    }

                    // reveal the active accordion bodies
                    $('.js-accordion-item.active').find('> .js-accordion-body').show();
                },
                toggle: function ($this) {

                    if (settings.oneOpen && $this[0] != $this.closest('.js-accordion').find('> .js-accordion-item.active > .js-accordion-header')[0]) {
                        $this.closest('.js-accordion')
                            .find('> .js-accordion-item')
                            .removeClass('active')
                            .find('.js-accordion-body')
                            .slideUp()
                    }

                    // show/hide the clicked accordion item
                    $this.closest('.js-accordion-item').toggleClass('active');
                    $this.next().stop().slideToggle(settings.speed);
                }
            }
        })();

        $(document).ready(function () {
            accordion.init({speed: 300, oneOpen: true});
        });
    </script>
    <script>
        const categoryButtons = document.querySelectorAll('.us-products-page-categories-list-item-button')
        const subcategoryBlocks = document.querySelectorAll('.us-products-page-subcategories-listHolder')
        const closeSubcategoryBlockButtons = document.querySelectorAll('.us-products-page-subcategories-backButton')
        const closeSubcategoryBlockButtons2 = document.querySelector('.closeSubBtn')
        const categoryListBlock = document.querySelector('.us-products-page-categories-list')
        const categorySearchInput = document.querySelector('.us-products-page-categories-searchBlock-input')
        const categorySearchBlock = document.querySelector('.us-products-page-searchcategories-list')
        const filterItems = document.querySelectorAll('.us-products-page-filterBlock-item')

        categoryButtons.forEach(button => {
            button.addEventListener('click', () => {
                categoryListBlock.style.display = 'none'
                let categoryID = button.parentElement.id;
                subcategoryBlocks.forEach(subcategory => {
                    if (subcategory.id === categoryID) {
                        subcategory.classList.add('active')
                    }
                })
            })
        })

        closeSubcategoryBlockButtons.forEach(closeBtn => {
            closeBtn.addEventListener('click', () => {
                closeBtn.parentElement.classList.remove('active')
                categoryListBlock.style.display = 'block'
            })
        })


        // Search Function
        let categories = []
        let allSubCategories = document.querySelectorAll('.us-products-page-subcategories-list-item-title');

        // Push all subcategories
        allSubCategories.forEach(subcategory => {
            console.log()
            let subcatTitle = {}
            subcatTitle.name = subcategory.innerHTML
            subcatTitle.href = subcategory.parentElement.href
            categories.push(subcatTitle)
        })

          var render_lists = function(lists){
            var li = ``;
            for(index in lists){
              li += `<li class="us-products-page-categories-list-item-2">
                  <a href="${lists[index].href}">
                      <span class="us-products-page-categories-list-item-title">${lists[index].name}</span>
                  </a>
          </li>`;
            }
            categorySearchBlock.innerHTML = li;
          }

          render_lists(categories);

          var filterUsers = function(event){
            keyword = categorySearchInput.value.toLowerCase();
            filtered_users = categories.filter(function(category){
                category = category.name.toLowerCase();
                 return category.indexOf(keyword) > -1;
            });

            render_lists(filtered_users);
          }

          categorySearchInput.addEventListener('input', (e)=> {
            if (e.target.value.length <= 1) categorySearchBlock.classList.remove('active')
            else categorySearchBlock.classList.add('active')
            filterUsers()
          });

          let elementsList = []
          filterItems.forEach(element => {
            if (element.classList.contains('active')) {
                elementsList.push(element)
            }
            element.addEventListener('click', () => {
                elementsList[0].classList.remove('active')
                elementsList.splice(0, 1)
                element.classList.add('active')
                elementsList.push(element)
                // console.log(element.sibl);
            })
          })

        //   Filter Price
        const priceFilterBtn = document.querySelector('.us-products-page-filterBlock-viewBtn.price-filter')
        const priceFilterBlock = document.querySelector('.us-products-page-filtersection-pricefilterBox')

        priceFilterBtn.addEventListener('click', () => {
            priceFilterBlock.classList.toggle('active')
        })

        // Products View
        const productsGridViewBtn = document.querySelector('.gridView')
        const productsGridView = document.querySelector('.us-products-page-products-grid-list')
        const productsHorViewBtn = document.querySelector('.horView')
        const productsHorView = document.querySelector('.us-products-page-products-horizontal-view')

        productsGridViewBtn.addEventListener('click', () => {
          productsHorViewBtn.classList.remove('active')
          productsHorView.classList.remove('active')
          productsGridViewBtn.classList.add('active')
          productsGridView.classList.add('active')
        })
        productsHorViewBtn.addEventListener('click', () => {
          productsGridViewBtn.classList.remove('active')
          productsGridView.classList.remove('active')
          productsHorViewBtn.classList.add('active')
          productsHorView.classList.add('active')
        })
    </script>
    <!--asd-->

{% endblock %}