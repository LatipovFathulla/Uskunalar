{% extends 'layouts/base.html' %}
{% load i18n %}
{% block title %} {{ object.title }}  {% endblock %}
{% load static %}
{% load tags %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css" />
    <style>
    dl, ol, ul {
        margin-bottom: 0;
    }
    .us-products-page-products-productCard {
        width: auto;
    }
    .us-products-page-products-productCard_top {
        max-width: -webkit-fill-available;
        max-width: -moz-available;
        max-width: stretch;
        width: 100%;
    }
    .us-products-page-products-productCard-detailsView , us-products-page-products-productCard-preview{
        max-width: -webkit-fill-available;
        max-width: -moz-available;
        max-width: stretch;
        width: 100%;
        max-height: -webkit-fill-available;
        max-height: -moz-available;
        max-height: stretch;
        height: 100%;
    }

    .us-products-page-products-productCard-moreLink {
        width: auto;
    }
    </style>
   <div class="us-navigation-block">
        <div class="us-products-page-container">
            <ul class="us-navigation-block-list">
                <li class="us-navigation-block-item">
                    <a href="{% url 'home:home' %}" class="us-navigation-block-link">{% trans 'Главная' %}</a>
                </li>
                <li class="us-navigation-block-item">
                    <a href="{% url 'line:lines' %}" class="us-navigation-block-link">{% trans 'Liniyalar' %}</a>
                </li>
                <li class="us-navigation-block-item">
                    <a href="{% url 'line:lines' %}" class="us-navigation-block-link">{{ object.title|safe }}</a>
                </li>
            </ul>
        </div>
    </div>

 <div class="us-single-line">
        <div class="us-single-line-container">
            <aside class="us-single-line-latest">
                <div class="us-single-line-latest-container">
                    <h3 class="us-single-line-latest-title"><i class="fa-regular fa-circle-small"></i> {% trans "O'xshash liniyalar" %}
                    </h3>
                    <ul class="us-single-line-latest-listOfLines">
                        {% for line in random_lines %}
                              <li class="us-single-line-latest-ItemLine">
                                <h5 class="us-single-line-latest-ItemLine-price"><i class="fa-light fa-tag"></i> ${{ line.price }}</h5>
                                <a href="{% url 'line:detail' pk=line.pk %}" class="us-single-line-latest-ItemLine-title">{{ line.title }}</a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </aside>
            <div class="us-single-line-mainBlock">
                <div class="us-single-line-mainBlock-container">
                    <!-- Top Buttons -->
                    <div class="us-single-line-mainBlock-meta">
                        <div class="us-single-line-mainBlock-metaViewShare">
                            <p class="us-single-line-mainBlock-view"><i class="fa-light fa-eye"></i>  {{ object.views }}</p>
                            <ul class="us-single-line-mainBlock-share-links">
                                <li class="us-single-line-mainBlock-share-link"><a class="copyClipboard"
                                        rel="noopener noreferrer"><i title="Havolani ko'chirish"
                                            class="fa-light fa-link-simple"></i></a>
                                </li>
                                <li class="us-single-line-mainBlock-share-link"><a href="https://t.me/share/url?url={{ request.get_host }}{{ request.get_full_path }}&text={{ object.title }}" target="_blank"
                                        rel="noopener noreferrer"><i title="Telegram"
                                            class="fa-brands fa-telegram"></i></a>
                                </li>
                                <li class="us-single-line-mainBlock-share-link"><a href="https://wa.me/?text={{ request.get_host }}{{ request.get_full_path }}" target="_blank"
                                        rel="noopener noreferrer"><i title="WhatsApp"
                                            class="fa-brands fa-whatsapp"></i></a>
                                </li>
                                <li class="us-single-line-mainBlock-share-link"><a href="https://www.facebook.com/sharer/sharer.php?u={{ request.get_host }}{{ request.get_full_path }}" target="_blank"
                                        rel="noopener noreferrer"><i title="Facebook"
                                            class="fa-brands fa-facebook"></i></a>
                                </li>
                            </ul>
                        </div>
                        <a href="{{ object.pdf.url }}"><button class="us-single-line-mainBlock-meta-downloadPDF"><i class="fa-regular fa-files"></i>
                            Download PDF</button></a>
                    </div>

                    <h1 class="us-single-line-mainBlock-line-title">{{ object.title }}</h1>

                    <div class="us-single-line-mainBlock-line-fullDescription">
                            {{ object.long_description|safe }}
                    </div>
                </div>
            </div>
            <aside class="us-single-line-recAndPopularBlock">
                <div class="us-single-line-recAndPopularBlock-container">

                    <div class="us-single-line-recAndPopularBlock-first">
                        <h3 class="us-single-line-recAndPopularBlock-title"><i class="fa-regular fa-circle-small"></i>
                            {% trans "Tavsiya qilamiz" %}</h3>
                        <ul class="us-single-line-recAndPopularBlock-listOfLines">
                            {% for line in random_line %}
                            <li class="us-single-line-recAndPopularBlock-ItemLine">
                                <h5 class="us-single-line-recAndPopularBlock-ItemLine-price"><i
                                        class="fa-light fa-tag"></i>
                                    ${{ line.price }}</h5>
                                <a href="{% url 'line:detail' pk=line.pk %}" class="us-single-line-recAndPopularBlock-ItemLine-title">{{ line.title }}</a>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>

                    <div class="us-single-line-recAndPopularBlock-second">
                        <!-- Slider main container -->
                        <div class="swiper us-productsRec">
                            <!-- Additional required wrapper -->
                            <div class="swiper-wrapper us-productsRec-swiper">
                                <!-- Slides -->
                                {% for product in random_prod_line %}
                                      <div class="swiper-slide">
                                             {% include 'layouts/product-block2.html' %}
                                      </div>
                                {% endfor %}


                            </div>
                            <!-- If we need pagination -->
                            <div class="swiper-pagination"></div>

                            <!-- If we need navigation buttons -->
                            <!-- <div class="swiper-button-prev"></div>
                            <div class="swiper-button-next"></div> -->

                            <!-- If we need scrollbar -->
                            <!-- <div class="swiper-scrollbar"></div> -->
                        </div>
                    </div>

                </div>
            </aside>
        </div>
    </div>
<script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js" ></script>
<script>
const usProductsRec_swiper = new Swiper('.us-productsRec', {
    // Optional parameters
    spaceBetween: 10,
        centeredSlides: true,
        autoplay: {
          delay: 2500,
          disableOnInteraction: true,
        },
  });
</script>
<script>
    function add_to_wishlist(element, pk) {
        $.getJSON('/products/' + "wishlist/" + pk, function (data) {
            if (!data.status) {
               $('#message').append(`<div style="padding:5px">
                        <div id="inner-message" class="alert alert-error">
                            <button type="button" class="close" data-dismiss="alert">&times;</button>
                            Error
                        </div>
                    </div>`);
            } else {
                if (data.added) {
                    element.innerHTML = '<button class="us-products-page-products-productCard_ibutton product-heart" type="submit"><i class="fa-solid fa-heart red-heart"></i></button>'
                } else {
                    element.innerHTML = '<button class="us-products-page-products-productCard_ibutton" type="submit"><i class="fa-light fa-heart"></i></button>'
                }
                  $('#like_count').html(data.wishlist_len);
                  $('#like_count_2').html(data.wishlist_len);
            }
        });
    }
</script>

        <script>
    const copyClipboardBtn = document.querySelector('.copyClipboard')

    copyClipboardBtn.addEventListener('click', (e) => {
        e.preventDefault()
    let textToCopy = window.location.href
    if(navigator.clipboard) {
        navigator.clipboard.writeText(textToCopy).then(() => {
            alert('Copied to clipboard')
        })
    } else {
        console.log('Browser is not compatible')
    }

    })

    </script>
{% endblock %}